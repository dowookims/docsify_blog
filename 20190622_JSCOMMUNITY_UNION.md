#  JAVASCRIPT IS EVERYWHERE

###### 2019.06.22

## S1  CRA + SSRì„ êµ¬í˜„í•˜ë©° ë°°ìš´ ì  | ìŠ¹í˜•ìˆ˜

###### (feat. TS) ìŠ¹í˜•ìˆ˜ 20@kross.kr |[ìŠ¹í˜•ìˆ˜](https://github.com/hunskyhoochu)

ejectë¥¼ í•˜ì§€ ì•Šê³  ssrë¥¼ ì¨ë³´ì! ì—¬ê¸°ì„œ ì§ë©´í•œ ë¬¸ì œë“¤, ì—¬ê¸°ì„œ í•´ê²° í•´ì•¼ í•  ë¬¸ì œë“¤ì— ëŒ€í•´ì„œ.

### 1.  SERVER-SIDE-RENDERING ?

ê¸°ì¡´ MVC íŒ¨í„´ì—ì„œëŠ” ë°ì´í„°ë¥¼ ì •ì˜í•˜ê³ , íŒŒì‹±í• ì§€ ê·œì¹™ì„ ì§œì„œ HTML template ë¬¸ë²•ì„ í†µí•´ í•œ ê°€ì§€ í˜ì´ì§€ì— ì ‘ì†ì„ í•˜ê²Œ ëœë‹¤ë©´ ê·¸ í˜ì´ì§€ì— ëŒ€í•œ ëª¨ë“  HTMLì„ ì›¹ í”„ë ˆì„ì›Œí¬ì—ì„œ ë‹¤ ì§œì£¼ê³  í†µìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë„˜ê²¨ì¤€ë‹¤(traditional)



But ì´ëŸ°ê²Œ ì ì  ë²„ê±°ì›Œì§€ê¸° ì‹œì‘í•˜ëŠ”ë°, ìˆ˜ë§ì€ ì‚¬ëŒë“¤ì´ ì„œë²„ì— ëª°ë¦¬ë©´ ì„œë²„ì— ë¸Œë¼ìš°ì§• í•  ë•Œë§ˆë‹¤ ì´ ì—°ì‚°ì„ ì„œë²„ê°€ ìŠ¤ìŠ¤ë¡œ ë§ˆì³ì„œ ë³´ë‚´ì¤˜ì•¼ í•˜ëŠ”ë°, ì„œë²„ ìì›ì€ í•œì •ë˜ëŠ”ë° ìœ ì € ìš”ì²­ì„ ë‹¤ ì²˜ë¦¬í•œë‹¤ëŠ”ê²Œ íŠ¸ë˜í”½ì ìœ¼ë¡œ ë¶€ë‹´ì´ ëœë‹¤. ê·¸ëŸ¬ë‚˜ ìš”ìƒˆ ì»´í“¨í„°ê°€ ë‹¤ ì¢‹ì•„ì¡Œê¸° ë•Œë¬¸ì— ì´ ë¶€ë‹´ì„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¶€ë‹´ì„ í•˜ê² ë‹¤ í•´ì„œ ë‚˜ì˜¨ê²Œ `CSR`  ì´ë‹¤.



```
ë°±í™”ì ì—ì„œ ì™„ì œí’ˆì„ ì‚¬ì˜¤ëŠ” ê²ƒ? SSR
```



CSRì€ ìµœì†Œí•œì˜ htmlì„ ê·¸ë¦¬ê³ , í™”ë©´ ì „ì²´ ë Œë”ë§ì„ ìœ„í•œ JSë¥¼ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë³´ë‚´ì¤€ë‹¤. ì´ëŸ¬í•œ JSëŠ” ì‚¬ìš©ìì˜ ì»´í“¨í„°ì—ì„œ ì²˜ë¦¬í•˜ê²Œ ë˜ëŠ”ë°, ì´ë ‡ê²Œ í•˜ë©´ ì„œë²„ì˜ ê²½ìš° ì§„ì…í• ë•Œ ì»¤ë„¥ì…˜ë§Œ ì—´ì–´ì£¼ë©´ ë˜ê¸° ë•Œë¬¸ì— ì„œë²„ì—ì„œ ìˆ˜ë§ì€ ìš”ì²­ì— ëŒ€í•œ ë¶€ë‹´ì´ ì¤„ì–´ë“¤ê²Œ ëœë‹¤.

```
ì´ì¼€ì•„ì—ì„œ ì¡°ë¦½í˜• ì†ŒíŒŒë¥¼ ì‚¬ì™€ì„œ ì‚¬ìš©ìê°€ ì¡°ë¦½í•œë‹¤? => CSR
```



ê·¸ëŸ¬ë‚˜ ì—¬ê¸°ì„œ ë¬¸ì œê°€ ìƒê¸°ëŠ”ê²Œ, ì‚¬ìš©ì ê°™ì€ ê²½ìš°ëŠ” ë¬¸ì œê°€ ì—†ìœ¼ë‚˜ ì›¹ í¬ë¡¤ëŸ¬ê°€ í˜ì´ì§€ ì •ë³´ë¥¼ ê¸ì–´ ê°ˆ ë•Œ ì•„ë¬´ ë‚´ìš©ë„ ì—†ëŠ” ë¹ˆ í˜ì´ì§€ì´ê¸° ë•Œë¬¸ì— ì•„ë¬´ê²ƒë„ ê°€ì ¸ê°ˆ ìˆ˜ ì—†ì–´ì„œ SEO  ë¬¸ì œê°€ ìƒê¸´ë‹¤. ê·¸ë¦¬ê³  ëª¨ë“  ë°ì´í„°ë“¤ì„ í´ë¼ì´ì–¸íŠ¸ ì»´í“¨í„°ì—ì„œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë¡œë”©ì´ ëŠë¦¬ê³ , ì‚¬ìš©ì ì»´í“¨í„°ì— ë”°ë¥¸ ë¬¸ì œì— ëŒ€í•œ ì˜ˆì¸¡ì„ í•˜ê¸°ê°€ ì–´ë µê²Œ ëœë‹¤.



ê·¸ë˜ì„œ SSRì€ ì´ˆê¸° ë Œë”ë§ì„ ë§ˆì¹œ  HTMLê³¼ ì¼ë¶€ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•œ JSë¥¼ ë³´ë‚¸ë‹¤. ì¦‰, ì„œë²„ì—ì„œ ê¸°ë³¸ì ì¸ êµ¬ì„±ì´ ë˜ê¸° ë•Œë¬¸ì— ê²€ìƒ‰ì—”ì§„ì´ ëŒ€ì‘í•˜ê¸°ì— ì¢‹ë‹¤.

```
ìœ„ì—ì„œ í•œë²ˆ, ì¥ì—ì„œ í•œë²ˆ
```

ì„œë²„ì—ì„œ ê°„ë‹¨í•œ ë Œë”ë§ì„ í•œë²ˆ í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•œë²ˆ ë” í•¨ìœ¼ë¡œì¨ ë” íš¨ìœ¨ì ìœ¼ë¡œ ì‘ìš©í•˜ê²Œ í•˜ëŠ”ê²Œ SSR



### 2. Implementation

ì„œë²„ì—ì„œ í•œë²ˆ

1) ReactDOMServer.renderToString() í•¨ìˆ˜ë¡œ react appì„ html string ìœ¼ë¡œ ë³€í™˜

2) ì„œë²„ì˜ '^/$' routeì—ì„œ ì¶œë ¥í•˜ê²Œ í•œë‹¤.

í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë˜ í•œë²ˆ

3) 'build/index.html'ì—ëŠ” react ëŸ°íƒ€ì„ ì½”ë“œì™€ í˜ì´ì§€ ì½”ë“œê°€ ë¶™ì–´ìˆìŒ!

4) ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ staticìœ¼ë¡œ ì„œë²„ì— ì œê³µí•˜ì.

```react
// src/html.text
export default ReactDOMServer.renderToString(<App />);
```

```tsx
// server/htmlRenderer.tsx

export default (html: string, htmlPath: string) => (req:express.Request, res: express.Response) => {
  fs.readFile(htmlPath. 'utf8'), (err,data) => {
    
  }
}
```

```tsx
// server/index.tsx
```



`data-reactroot` 

render | hydrate(render: ì „ì²´ HTML ë Œë”ë§  | hydrate: ê¸°ì¡´ HTMLê³¼ ë¹„êµ í›„ ë¶€ë¶„ ì—…ë°ì´íŠ¸)

```react
ReactDOM.hydrate(<App />, document.getElementById('root'));
```



componontDidMountê¹Œì§€ëŠ” ì„œë²„ ë Œë”ë§ì´ ëœë‹¤. ê·¸ëŸ¬ë‚˜ functioncal Componentì˜ hookì˜ ê²½ìš° ì•„ì§ ì´ë¶€ë¶„ì´ ì§€ì›ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í´ë˜ìŠ¤í˜• Componentë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ë‹¹

### 3. CHECK-LIST

ìŠ¤íŒŒê²Œí‹°ëŠ” ë¨¹ì„ ë•Œì—ë§Œ : ì„œë²„ì½”ë“œë¥¼ ë¶„ë¦¬í•˜ì

asset-manifest.json | build ì•ˆì— ë‹´ê¸´ ë³´ë¬¼ , ë¹Œë“œ ì•ˆì— ìˆëŠ” íŒŒì¼ì— ëŒ€í•œ íŒ¨ìŠ¤ë¥¼ jsonìœ¼ë¡œ ì¤Œìœ¼ë¡œ ì´ˆê¸° renderingì‹œ ìœ ìš©í•˜ê²Œ ì“¸ ìˆ˜ ìˆë‹¤.

ì§ì„ ë³´ë‹¤ ë¹ ë¥¸ êµ´ì ˆ | TypeScriptë¥¼ ì‚¬ìš©í•˜ëŠ” í¸ì´ ì¢‹ì€ ì´ìœ : ì„±ëŠ¥ ë˜ëŠ” ê°œë°œì—ì„œ ë”ìš©ì´í•˜ë‹¤.

#### 1) ìŠ¤íŒŒê²Œí‹°ëŠ” ë¨¹ì„ ë•Œì—ë§Œ

`renderToString()` í•¨ìˆ˜ê°€ ì„œë²„ ì½”ë“œì™€ ì„ì´ê¸° ë§ˆë ¨ì´ë‹¤.  

ê·¸ë˜ì„œ `bootstrap.js` íŒŒì¼ì„ ì¶”ê°€ë¡œ ì‘ì„±í•´ ê°ìì˜ ì½”ë“œë¥¼ ë”°ë¡œ ë¶ˆëŸ¬ì˜¬ ê²ƒ.  express ê°ì²´ì™€ renderToString()ì˜ ê²°ê³¼ë¬¼ì„ bootstrap.jsì—ì„œ ê°€ì ¸ì™€ app.listen()ì„ í•˜ëŠ”ê²Œ ë” ë‚˜ì„ì§€ë„ ëª¨ë¥¸ë‹¤.

`.git submodule` ìš´ìš© ê°€ëŠ¥ : SSR SERVERë¥¼ ë”°ë¡œ ë§Œë“¤ì–´ git repoë‚´ë¶€ì˜ ë„ ë‹¤ë¥´ repo ì°¸ì¡° íŒŒì¼ì„ í†µí•´ ê´€ë¦¬ ğŸ‘©â€ğŸ’¼ ğŸ‘¨â€ğŸ’¼!

ì´ ë¶€ë¶„ì€ coupling ì½”ë“œë¥¼ ë§‰ê¸° ìœ„í•´ì„œ

ê·¸ë˜ì„œ ê²°êµ­ì€

Asset-manifest.json : buildí´ë”ì— ìƒì„±ëœ ëª¨ë“  ìì‚°ì˜ ì¼ëŒí‘œ. html stringì„ ë§Œë“¤ ë•Œ static fileì˜ ì°¸ì¡°ë¥¼ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤. 

{Logo} => ë¥¼ ìƒëŒ€ì£¼ì†Œë¡œ ì…ë ¥ì“° í•´ì¤€ë‹¤. ì´ ë¶€ë¶„ì€ ë‚˜ì¤‘ì— ë”°ë¡œ ë” ìì„¸íˆ ë³¼ ê²ƒ.

### 2) ì§ì„ ë³´ë‹¤ ë¹ ë¥¸ êµ´ì ˆ

ì™œ TSê°€  SSRì— ë„ì›€ì´ ë ê¹Œ? Tsc ì»´íŒŒì¼ì„ í†µí•´. CommonJS íŒŒì¼ ìƒì„± ê°€ëŠ¥ => babelì„ ì“°ì§€ ì•Šì•„ ì„±ëŠ¥ í–¥ìƒ:rocket:

ê±°ê¸°ì— íƒ€ì… ì²´í‚¹ìœ¼ë¡œ ì•ˆì „í•œ ì„¤ê³„ ê°€ëŠ¥.

### 4. Extra

í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì´ìŠˆ

* Redux

  ì„œë²„ ë Œë”ë§ ë‹¨ê³„ì—ì„œ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì£¼ì…í•˜ê³  ì‹¶ì„ ë•Œë§Œ ì‚¬ìš©. index.htmlì— ì¸ë¼ì¸ìœ¼ë¡œ window ì „ì—­  storeê°ì²´ ì‚½ì… -> í´ë¼ì´ì–¸íŠ¸  ì½”ë“œê°€ ì½ì–´ë“¤ì„

  <script></script>

* React-router-dom: 

* React-Loadable: 



_ì„±ê³µë³´ë‹¤ ë¹ ë¥¸ ì‹œí–‰ì°©ì˜¤ë¥¼ ì‘ì›í•©ë‹ˆë‹¤_



##S2  ë‚˜ì˜ JS  ì‚¬ìš©ê¸° | ìµœì¢…ìš±



##S3 Nuxtë¡œ 

1. Single page application (nuxt build â€”spa) 
2. statically generated (nuxt generate)
3. server side render(nuxt build) => ec2, lambda í•„ìš”(nodeë¡œ) serverless

### Serverless framework

Build web mobile and Not applications with serverless architectures using AWS Lambda, Azure Functions, Google CloudFunctions & more

AWS Lambda ë¡œ CloudFormationì„ í†µí•´ ë™ì‘í•œë‹¤.

ì„œë¹„ìŠ¤ë¥¼ ë§Œë“¤ë•Œ ì†ŒìŠ¤ì½”ë“œë§Œ ì‘ì„±í•˜ë©´ ë˜ëŠ”ë° RDSë‚˜ í‚¤ë„¤í‹±ìŠ¤ë“±ì„ ì„œë²„ë¦¬ìŠ¤ í”„ë ˆì„ì›Œí¬ì— ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

ì„œë²„ë¦¬ìŠ¤ í”„ë ˆì„ì›Œí¬ë¡œ ì„œë¹„ìŠ¤ ë³„ ë§ˆì´í¬ë¡œ ì•„í‚¤í…ì²˜ ê´€ë¦¬, ìœ ì§€ ê°€ëŠ¥

Serverless.yamlë¥¼ ì‘ì„±í•œë‹¤. ì¸í„°ë„· ì°¸ê³ .

serverlessì—ì„œ HTTP eventëŠ” API Gatewayë¥¼ ì‚¬ìš©í•œë‹¤. ë³´í†µì€ APIë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©í•œë‹¤.

ê·¸ëŸ°ë° ì™œ Serverlessì— nuxtë¥¼ ì˜¬ë ¤ì•¼ í•˜ëŠ”ê°€?

serverless ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¥ì ìœ¼ë¡œì¨

* ê³¼ê¸ˆì€ ì‚¬ìš©í•œ ë§Œí¼ë§Œ(ë‚˜ë…¸ ì¨ë„ í•œë‹¬ì— ë§Œì› ì •ë„ ë‚˜ì˜´) => ë§ì´ ì¨ë„ í™•ì¥ í•  í•„ìš” ì—†ì´ ì“´ë§Œí¼ë§Œ ë‚´ë©´ëœë‹¤.
* Auto Scale(ì´ê±¸ ìë™ìœ¼ë¡œ í•´ì¤€ë‹¤.)
* ë¬´ì¤‘ë‹¨ ë°°í¬: ServerlessëŠ” ë°°í¬í•˜ë©´ ë°”ë¡œ ë°˜ì˜í•œë‹¤(ë¡œë“œ ë°¸ëŸ°ìŠ¤ì— ëŒ€í•œ ê³ ë ¤ë¥¼ í•  í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤.)

Nuxt Serverless êµ¬í˜„ë„ ìƒê°ë³´ë‹¤ ì‰½ë‹¤. API ì„œë²„ ë§Œë“œëŠ” ê²ƒì²˜ëŸ¼

[github](GitHub.com/wan2land/js2019-serverless-nuxt)

Serverless.yaml ì‘ì„±í•´ì•¼ í•œë‹¤.

Nuxtë„ expressë¥¼ ì“°ê³ , ì´ê±¸ lambdaì— ë„£ì„ ìˆ˜ ìˆë‹¤.



ë°ì´í„° ì €ì¥ìš©ìœ¼ë¡œëŠ” S3ë¥¼ ì‚¬ìš©í•œë‹¤(ì €ì¥ í•  ë•Œë§Œ ê¸ˆì•¡ ì²­êµ¬ë¨)

ëŒë‹¤ì˜ ì†ŒìŠ¤ì½”ë“œ ìµœëŒ€ì—…ë¡œë“œ ê°€ëŠ¥í•œ ìš©ëŸ‰ì€ 250mb ëŒ€ë¶€ë¶„ì˜ ìš©ëŸ‰ì€ ì´ë¯¸ì§€ + í°íŠ¸ë¼ì„œ ì´ ë¶€ë¶„ì€ s3ë¡œ ì €ì¥í•˜ëŠ”ê²Œ ë‚«ë‹¤.

Nuxtì˜ ê²½ìš° ë°°í¬ í•  ë•Œ í´ë¼ì´ì–¸íŠ¸ / ì„œë²„ê°€ ë‚˜ë‰˜ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ ê´€ë ¨ ì†ŒìŠ¤ë§Œ ì˜¬ë¦¬ë©´ ëœë‹¤.

ì •ì íŒŒì¼ ì²˜ë¦¬: ìš”ì²­ë°›ìœ¼ë©´ ì •í•´ì§„ íŒŒì¼ì„ ë˜ì ¸ì£¼ëŠ”ë° ì´ë¥¼ ë§¤ë„ëŸ½ê²Œ ì²˜ë¦¬í•´ì•¼ í•  í•„ìš”ê°€ ìˆë‹¤.

* ê·¸ì´ìœ ë¡œ ë¹„ìš©ì ˆê°,  ìš©ëŸ‰ì ˆê°, ë¬´ì¤‘ë‹¨ ë°°í¬ê°€ ê°€ëŠ¥í•˜ë‹¤.

ì¼ë°˜ ì›¹ì‚¬ì´íŠ¸ ë°°í¬ë¥¼ í•  ë•Œ ì¼ë°˜ ì›¹ì‚¬ì´íŠ¸ì— ë“¤ì–´ê°€ë©´ HTMLì„ ë¶ˆëŸ¬ì˜¤ê³  ì´ ì•ˆì— ìˆëŠ” css, jsë¥¼ ê°€ì§€ê³  ì˜¨ë‹¤. ê·¸ë¦¬ê³  ë°°í¬ê°€ ëœë‹¤. ë¸Œë¼ìš°ì €ì— ìºì‹±ì´ ë˜ëŠ”ë°, ì‚¬ìš©ìê°€ ìƒˆë¡œìš´ í˜ì´ì§€ë¡œ ì´ë™ ì‹œ html íŒŒì¼ì„ ê°€ì§€ê³ ì˜¤ê³  js, cssë¥¼ ê°€ì§€ê³  ì˜¨ë‹¤.

SSR FRAMEWORKì—ì„œëŠ” í˜ì´ì§€ ì´ë™ì‹œ ìë°”ìŠ¤í¬ë¦½íŠ¸ ë“± í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë§Œ ê°€ì ¸ì˜¤ê²Œ ë˜ëŠ”ë° ì²«ë²ˆì§¸ í™”ë©´ì„ ë³´ê³  ìˆëŠ” ìƒíƒœì—ì„œ ë°°í¬ê°€ ë  ê²½ìš° ì›ë˜ ìˆë˜ íŒŒì¼ë“¤ì€ ë‹¤ ì‚¬ë¼ì§€ê³  ê·¸ ë‹¤ìŒ ë²„ì „ì´ ë‚˜íƒ€ë‚˜ê²Œ ë˜ëŠ”ë° ì´ ì™€ì¤‘ì— ì‚¬ìš©ìê°€ í˜ì´ì§€ë¥¼ ì´ë™í•˜ë©´ urlì„ ì´ì „ì— ê²ƒì„ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ì›í•˜ëŠ” ìš”ì²­ íŒŒì¼ë„ ì—†ì–´ì§€ê³ , íŒŒì¼ì´ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ë‚˜ì˜¤ë©´ì„œ ì‚¬ìš©ìê°€ ì´ìš© ì‚¬í•­ì— ë¬¸ì œê°€ ìƒê¸´ë‹¤. ë¬¼ë¡  ì‚¬ìš©ìê°€ ìƒˆë¡œ ê³ ì¹¨ì„ í•˜ë©´ ë¬¸ì œê°€ ì—†ì§€ë§Œ, ì´ëŸ°ê²ƒë„ ì²˜ë¦¬í•´ ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì—, ì •ì  íŒŒì¼ì„ ì²˜ë¦¬í•˜ë©´ ì´ëŸ° ë¬¸ì œë“¤ì´ í•´ê²°ëœë‹¤ê³  í•œë‹¤.



ì¦‰, s3ë¥¼ cdnì²˜ëŸ¼ ì‚¬ìš©í•´ì„œ static fileë¡œ ê°€ì ¸ì˜¤ëŠ”ê²Œ í¸í•˜ë‹¹.



1. Serverless.yml íŒŒì¼ì— cloudFormationì„ ì´ìš©í•˜ì—¬. s3 bucketì„ ì‚¬ìš©í•œë‹¤.
2. nuxt.config.js íŒŒì¼ì— publicPath ì˜µì…˜ì— s3 bucket URL ì§€ì •í•œë‹¤.
3. nuxt build í•œê²ƒì„ s3ì— ì˜¬ë ¤ì•¼ í•˜ëŠ”ë°

ìˆ˜ë™ìœ¼ë¡œ ì—…ë¡œë“œ í•  ìˆ˜ë„ ìˆëŠ”ë° ì´ë¥¼ ìë™í™” í•˜ëŠ” ë°©ë²•ì„ ê³ ë¯¼í•´ ë³´ì. ê·¸ë˜ì„œ ì°¾ì•„ë³¸ê²Œ Serverless plugin.

[ì„œë²„ë¦¬ìŠ¤ í”ŒëŸ¬ê·¸ì¸](Serverless.com/blog/writing-serverless-plugins)

ë°°í¬í•  ë•Œ ë‚˜ì˜¤ëŠ” ë‚´ìš©ë“¤ì„ ì•Œì•„ì•¼í•œë‹¤.

ì„œë²„ë¦¬ìŠ¤ ë¼ì´í”„ ì‚¬ì´í´

* Cleanup / initialize : ì²˜ìŒ ì—ë§Œ ë‚˜ì˜¤ëŠ”ë° ì„ì‹œíŒŒì¼ ì‚­ì œ, ë“±ë“±
* setUpProviderConfiguration : initialize ê³¼ì •ì—ì„œ ìƒì„±í•œ 
* createDeploymentArtifacts: ìš°ë¦¬ê°€ ì‘ì„±í•œ ì†ŒìŠ¤ì½”ë“œë¥¼ ì—…ë¡œë“œ í•  ìˆ˜ ìˆë„ë¡ ë¹Œë“œí•œë‹¤.
* compileFunctions, compileEvents: ì´ëŸ°ì €ëŸ°ê±°
* deploy => createStack, checkForChanges, uploadArtifacts, validateTemplate, updateStack

í”ŒëŸ¬ê·¸ì¸ì´ í•´ì•¼ í•  ì¼ : Serverlessë°°í¬ ì „ Nuxtë¥¼ ìë™ìœ¼ë¡œ ë¹Œë“œí•˜ê³  ë¹Œë“œ í›„ ìƒì„±ëœ ì •ì íŒŒì¼ì„ ë²„ì „ë³„ë¡œ s3ì— ì—…ë¡œë“œ í•œë‹¤.

í”ŒëŸ¬ê·¸ì¸ HookPoint: createDeploymentArtifacts. í›…ì„ ì´ ë¼ì´í”„ ì‚¬ì´í´ ì§ì „ì— ë„£ì–´ì¤€ë‹¤. deployì´í›„ì— íŒŒì¼ì„ ì—…ë¡œë“œ í•´ì•¼ í•œë‹¤. í´ë¼ìš°ë“œ í¬ë©”ì´ì…˜ì„ í†µí•´ì„œ s3 ë²„í‚·ì„ ë§Œë“¤ì—ˆê¸° ë•Œë¬¸ì— deployì´í›„ ì ì‘ì´ ëœë‹¤.

`github ì°¸ê³ `

í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©í•´ë³¸ë‹¤.

`github ì°¸ê³ `

ëŒë‹¤ì™€s3ì˜ ê²½ìš° ë¦¬ì „ ì¢…ì†ë˜ê¸° ë•Œë¬¸ì— lambda@edgeì™€ ë“±ë“±ì„ ê³ ë ¤í•´ì„œ  cdnì²˜ë¦¬ë¥¼ í•´ë³´ì•„ì•¼ í•œë‹¤.



$ https

Nginx, Apache ë“± ì‚¬ìš©í•˜ë©´ httpì—ì„œhttpsë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜ì„ ì‰½ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë‚˜ serverless ëŠ” api gatewayë¥¼ ì‚¬ìš©í•˜ê³ , ì´ëŠ” httpsë§Œì„ ì§€ì›í•œë‹¤. ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ httpsë¥¼ ì–¸ê¸‰í•´ì¤˜ì•¼ í•œë‹¤. nuxtëŠ” í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ë¥¼ ì˜¬ë¦¬ëŠ”ë° ì´ë¥¼ ê°•ì œí•  ìˆ˜ê°€ ì—†ë‹¤. ê·¸ë˜ì„œ ì´ê²Œ ì•½ì ì•„ë‹Œ ì•½ì ì²˜ëŸ¼ ë¬ì—ˆëŠ”ë°,  lambdaì—ì„œ application loadbalancerì—ì„œ ì´ eventë¥¼ ì§€ì›í•˜ê³  ì €ë²ˆ ì£¼ ìˆ˜ìš”ì¼ì— ê°€ëŠ¥í•˜ê²Œ ë˜ì—ˆë‹¹.





ìš”ì•½!

1. nuxt ì˜ her ì¥ì  ê·¸ëŒ€ë¡œ ê°œë°œí•˜ì¥
2. nuxt serverlessë¡œ lambdaìœ„ì— ìš´ì˜í•´ì„œ ë¹„ìš©ì ˆê°
3. serverless nuxt í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì‰½ê²Œ ì ìš© ê°€ëŠ¥
4. ê¸€ë¡œë²Œ ì„œë¹„ìŠ¤ ì‰½ê²Œ í•  ìˆ˜ ìˆë‹¹





##S4 React Hooks + TS + functional = ì•„ë¦„ë‹¤ì›€ | ìœ ìœ¤ì¬

###### CEO of DNext Inc. block chain based service with RN = Alice(Cross Platform)

dynamic typing => null point error etcâ€¦. => how can make stable SW?

1. use Functional Components | 16.8
2. TypeScript | Compile tyime type check
3. React Hooks | Code Reuse seems like making react as new



### 1. Functional Component

Old source code => class based code

* make member variables, methods render( use JSX like html)
* use lifeCycle method



functional component => simple

use arrow function. no need to use complex things.

return í‚¤ì›Œë“œë¥¼ ìƒëµí•˜ê³  ë”ìš± ê°„ê²°í•˜ê²Œ ì‘ì„±í•  ìˆ˜ë„ ìˆë‹¤.



ì£¼ì˜í•´ì•¼ í•  ì‚¬í•­ìœ¼ë¡œ í•¨ìˆ˜ ë‚´ì˜ ë¡œì§ì€ ë Œë”ë§ì´ ìˆ˜í–‰ë  ë•Œ ë§ˆë‹¤ ë§¤ë²ˆ ê³„ì‚°ëœë‹¤ => useCompute

* ë¬´ê±°ìš´ ê³„ì‚°í•˜ëŠ” ë‚´ìš©ì„ ì´ functional componentë‚´ì— ë„£ëŠ”ê²ƒì€ ë³„ë¡œ ì•ˆì¢‹ë‹¤. 

* í•¨ìˆ˜ ë‚´ì—ì„œ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ë§Œë“¤ë©´ ë”ë”ìš± ì˜¤ë²„í—¤ë“œê°€ í¬ë‹¤.
* í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” this.propsë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ì—†ë‹¤. í•¨ìˆ˜ì˜ ì¸ìë¡œ ë°›ì•„ì•¼ í•œë‹¤. ì™œëƒí•˜ë©´ thisëŠ” ê¸€ë¡œë²Œ ê°ì²´ë¡œ ì¡í˜€ìˆê¸° ë•Œë¬¸ì—(thisëŠ” í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©, ê·¸ ì™¸ì— ì‚¬ìš©ì‹œ windowë¼ undefinedê°€ ëœ¬ë‹¤.)



### 2. ReactHooks

#### 1) useState

hookì´ë€ ë¦¬ì•¡íŠ¸ì—ì„œ ì§€ì›í•´ì£¼ëŠ” í•¨ìˆ˜ì˜ ì§‘í•©. í›…ì´ ë‚˜ì˜¨ ì´ìœ ëŠ” functional componentê°€ ì¡´ì¬í–ˆê³ , dumb componentê°€ ì¡´ì¬í–ˆê³  ì´ ì¹œêµ¬ëŠ” ìƒìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë³´ë‚´ì£¼ëŠ” propsë§Œ ì‚¬ìš©í–ˆìœ¼ë‚˜, functional programmingì´ ìœ í–‰í•˜ë©´ì„œ ì–´ë–»ê²Œ functional componentì—ë„ ë¡œì§ì„ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œ ê³ ë¯¼í•˜ë‹¤ ë‚˜ì˜¨ê²Œ React hook

```
import React, { useState} from 'react';
const MyComponent = ({ name }) => {
  const [ count, setCount ] = useState(0);
  return (
  	<View>
      <Button onpress={{this.onPress }}>
        <Text>Count: { count }</Text>
      </Button>
    </View>
  )
}
```

ë™ì ìœ¼ë¡œ ë³€í•˜ëŠ” ì¹´ìš´íŠ¸ ê°’ì„ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.

useStateì— ê°’ì´ ì•„ë‹Œ í•¨ìˆ˜ë¥¼ ì „ë‹¬ í•  ìˆ˜ ìˆëŠ”ë° ì˜ˆë¥¼ ë“¤ì–´ ì•„ê¹Œ ë‚˜ì˜¨ ë¬´ê±°ìš´ ì‘ì—…ì„ í†µí•´ ì´ˆê¸°ê°’ì„ ì„¤ì •í•´ì•¼ í•  ê²½ìš°ì—ëŠ”

```react
const MyComponent = ({ name }) => {
  const [ count, setCount ] = useState(() => intenseCalculation());
  ë“±ë“±
}
```

ì´ë ‡ê²Œ í•˜ë©´ countê°€ setë ë•Œ í•œë²ˆ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ê³  ì´ ì´í›„ call í• ë•Œ í•¨ìˆ˜ê°€ ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.

ë˜í•œ stateì˜ ëŒ€ìƒì´ ë˜ëŠ” ê°’ì€ ë°°ì—´, ê°ì²´ë„ ë  ìˆ˜ ìˆë‹¤.

**ëª¨ë“  í›…ì€ í•¨ìˆ˜ì˜ ìµœìƒìœ„ ë ˆë²¨ì—ì„œ í˜¸ì¶œë˜ì–´ì•¼ í•˜ë¯€ë¡œ í•¨ìˆ˜ ì•ˆì—ì„œ í˜¸ì¶œë  ìˆ˜ ì—†ë‹¤**

ê·¸ ì´ìœ ëŠ” í›…ì´ í˜¸ì¶œë˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ ë³µì¡í•œ ê³¼ì •ìœ¼ë¡œ stateë¥¼ ê´€ë¦¬í•˜ëŠ”ë°, í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” ìˆœì„œë¥¼ ê¸°ë¡í•˜ê³ , ì—¬ëŸ¬ê°œì˜ í›…ì´ ìˆë‹¤ë©´ ë‹¤ ê¸°ë¡í•˜ê³  ë‹¤ìŒë²ˆ ë Œë”ë§ì´ ë¬ì„ ë•Œ í›…ì´ ì‹¤í–‰ë˜ë©´ ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìºì‹±ë˜ì–´ ìˆëŠ” ìƒíƒœì™€ ë¹„êµí•´ì„œ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— ê·¸ ìˆœì„œê°€ ííŠ¸ëŸ¬ì§€ë©´ ì•ˆë˜ë¯€ë¡œ ë°˜ë“œì‹œ í›…í•¨ìˆ˜ëŠ” ì–´ë–¤ì¼ì´ ìˆë”ë¼ë„ ì „ë¶€ë‹¤ ìµœìƒìœ„ì— ê¸°ë¡ ë˜ì–´ì•¼ í•œë‹¤.



#### 2) useCallback()

í˜¸ì¶œë  í•¨ìˆ˜, ì¬ ê³„ì‚°ì„ ìœ„í•œ ì˜ì¡´ì„± ëª©ë¡ì„ ì¸ìë¡œ ë°›ëŠ”ë‹¤.

```react

import React, { useState, useCallback } from 'react';
const MyComponent = ({ name }) => {
  const [ count, setCount ] = useState(0);
  const onPress = useCallback(() => setCount(count +1 ), [count])
  return (
  	<View>
      <Button onpress={{ onPress }}>
        <Text>Count: { count }</Text>
      </Button>
    </View>
  )
}
```

useCallbackì€ ë’¤ì— ìˆëŠ” ë””íœë˜ì‹œ ë‚´ìš©ì´ ë‹¬ë¼ì§ˆ ë•Œë§Œ ë‹¤ì‹œ callBackì„ í˜¸ì¶œí•˜ì—¬ ê°’ì„ ê³„ì‚°ëœë‹¤. ë§Œì•½ ë’¤ì— ì¸ìê°€ ì—†ìœ¼ë©´ ì²˜ìŒ ë Œë”ë§ì‹œë§Œ ê³„ì‚°í•˜ê³  ê·¸ ì´í›„ì— ê³„ì‚°ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ë˜ì„œ ê³„ì‚°í•  ë•Œ ë§ˆë‹¤ ê³„ì† 1ë¡œ ì„¸íŒ…ë˜ê¸° ë•Œë¬¸ì— ë°˜ë“œì‹œ dependencyì— ë¬´ì–¸ê°€ë¥¼ ë„£ì–´ ì£¼ì–´ì•¼ í•œë‹¤. ë°°ì—´ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ìœ„ë¥¼ ì°¸ê³  í• ê²ƒ.



asyncí•¨ìˆ˜ë„ ì§€ì›ëœë‹¤

```react
const onPress = useCallback(async() => {
  await funcAsync();
}, []);
```

useCallback ì‚¬ìš©ì‹œ ë‘ë²ˆì§¸ ì¸ìì— ë¹ˆ ë°°ì—´ì„ ì „ë‹¬í•˜ë©´ ì½œë°± í•¨ìˆ˜ëŠ” ìµœì´ˆ ìƒíƒœë¡œ ê³ ì •ë˜ê³  ì´í›„ì— ì¬ê³„ì‚° ë˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë²¤íŠ¸ê°€ í•¸ë“¤ë§ ë˜ì§€ ì•Šì„ ë•Œ dependencyë¥¼ ì°¸ê³ í•  ê²ƒ



#### 3) useEffect

lifeCyclemethodëŠ” í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì— ì‚¬ìš© í•  ìˆ˜ ì—†ëŠ”ë°, ì´ ì¹œêµ¬ë¥¼ í†µí•´ ì‚¬ìš© í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆìë‹ˆë‹¤.

useEffect()ëŠ” í˜¸ì¶œë  í•¨ìˆ˜, ì¬ê³„ì‚°ì„ ìœ„í•œ ì˜ì¡´ì„± ëª©ë¡ì„ ì¸ìë¡œ ë°›ëŠ”ë‹¤. í•¨ìˆ˜ëŠ” ë Œë”ë§ì´ ì™„ë£Œëœ í›„ì— ìˆ˜í–‰ëœë‹¤.

ì´ëŠ” ë Œë”ë§ ëœ ì´í›„ useEffectë¥¼ ì‚¬ìš©í•œë‹¤. í˜¸ì¶œë˜ê³  ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹˜.

```react

import React, { useState, useCallback, useEffect } from 'react';
const MyComponent = ({ name }) => {
  const [ count, setCount ] = useState(0);
  const onPress = useCallback(() => setCount(count +1 ), [count]);
  useEffect(() => {
    alert(name);
    return () => {
      alrt("clean - up")
    }
  }, [name]);
  return (
  	<View>
      <Button onpress={{ onPress }}>
        <Text>Count: { count }</Text>
      </Button>
    </View>
  )
}
```

useEffectëŠ” ì •ë¦¬ í•¨ìˆ˜(clean-up function)ë¥¼ ë¦¬í„´í•  ìˆ˜ ìˆë‹¤.ì´ëŠ” componentWillUnmount()ì— í•´ë‹¹í•œë‹¤.

useEffectì—ì„œ ì „ë‹¬í•˜ëŠ” ë‘ë²ˆì§¸ ì¸ìì˜ ê°’ë“¤ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ í•¨ìˆ˜ê°€ ìˆ˜í–‰ëœë‹¤. ì´ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ componentDidMount()ì— í•´ë‹¹í•œë‹¤.

ì—¬ëŸ¬ê°œì˜ dependencyë¥¼ ì¶”ê°€ í•  ìˆ˜ ìˆìŒ.

useEffectì˜ ë‘ë²ˆì§¸ ì¸ìëŠ” ì „ë‹¬í•˜ì§€ ì•Šì•„ë„ ë˜ì§€ë§Œ ê·¸ëŸ´ ê²½ìš° í•¨ìˆ˜ëŠ” ë Œë”ë§ì´ ìˆ˜í–‰ë˜ëŠ” í”„ë ˆì„ë§ˆë‹¤ í˜¸ì¶œëœë‹¤.(í¼í¬ë¨¼ìŠ¤ ì´ìŠˆ)

ë¹ˆë°°ì—´ì„ í˜¸ì¶œí•˜ë©´ í•œë²ˆë§Œ í˜¸ì¶œí•˜ì§€ë§Œ, ì•„ë¬´ê²ƒë„ ì£¼ì§€ ì•Šìœ¼ë©´, ê³„ì† ë Œë”ë§ì„ í•œë‹¤. ì‘ì„±í•˜ë‹¤ ëŠë¦¬ë©´. useEffectì— ì˜ì¡´ì„±ì´ ì „ë‹¬ë˜ì—ˆëŠ”ì§€ í™•ì¸ í•  ê²ƒ

useEffectì—ì„œëŠ” async í•¨ìˆ˜ë¥¼ ì „ë‹¬ í•  ìˆ˜ ì—†ë‹¤. ê·¸ëŸ¬ë‚˜ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì •ì˜í•´ì„œ í˜¸ì¶œí•´ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ì§ì ‘ì ì¸ ì „ë‹¬ì´ ë¶ˆê°€ëŠ¥ í•œê²ƒ



#### 4)  customHook

ì—¬ëŸ¬ê°œì˜ í›…ì„ ë¬¶ì–´ì„œ ë‚˜ë§Œì˜ Hookì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

ì—¬ëŸ¬ê°€ì§€ ë¡œì§ì„ ë¬¶ì–´ì„œ ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤ ì»´í¬ë„ŒíŠ¸ë¡œëŠ” êµ¬í˜„í•  ìˆ˜ ì—†ëŠ” í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ë§Œì˜ ì¥ì 



```react
const MyComponent = (P name ) => {
  const { count, onPress } = useIncrementer(name);
  return (
  <View>
    	<Button onPress={onPress}>
        <Text>{ count }</Text>
      </Button>
  </View>

      )    
}

const useIncrement = (name: string) => {
  const [ count, setCount ] = useState(0);
  const onPress = useCallback(() => setCount(count + 1), [count]);
  useEffect(() => {
    alert(name);
  }, []);
  return { count, onPress};
}
```



### TS

Runtime ì— type checking í•˜ëŠ” propstypesê°€ ë¶ˆí¸í•˜ë‹¤. ì»´íŒŒì¼ ì‹œ ê°€ëŠ¥í•˜ê³  ì‹¶ë‹¤! => ts!

tsë¥¼ í•˜ë©´ ë” ëª…ì‹œì ì´ê³ 

```tsx
interface MyComponentProps {
  name?: string;
  age?: number;
  female: boolean;
}

const MyComponent: React.FunctionComponent<MyComponentProps> = ({ name, age, female})
=> {
  return (
      <View>
  	<Text>Name: {name}</Text>  
    <Text>age: {age}</Text>
   	<Text>female: {female}</Text>  
  </View>)
  )
}

//ë˜ëŠ”

const MyComponent = ({ name, age, female }: MyComponentProps) => {
  return (
  <View>
  	<Text>Name: {name}</Text>  
    <Text>age: {age}</Text>
   	<Text>female: {female}</Text>  
  </View>)
}

```

? ìˆìœ¼ë©´ string. ë˜ëŠ” undefined. ? ì—†ìœ¼ë©´ ë°˜ë“œì‹œ ì§€ì •ëœ íƒ€ì…ë§Œ.



```tsx
const [ count, setCount ] = useState(0); //ì¸ìì˜ ê°’ì„ ì¶”ë¡ í•˜ëŠ” ê¸°ëŠ¥ì´ ìˆìŒ
const [ count, setCount ] = useState<number>(0); // ìœ„ì—ê²ƒê³¼ ì´ê±°ëŠ” ë°˜ë“œì‹œ nullë§Œ ê°€ëŠ¥
const [ count, setCount ] = useState<number | null>(0);// count typeì€ number or null
```

```tsx
const onPress = useCallback((text) => alert(text), [text]);
const onPress = useCallback((text: string) => alert(text), [text]);
```